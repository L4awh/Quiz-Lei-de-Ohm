<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Quiz Lei de Ohm</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f5f5f5;
      margin: 0;
      padding: 20px;
      text-align: center;
    }
    .container {
      max-width: 600px;
      margin: auto;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 20px rgba(0,0,0,0.1);
    }
    button {
      padding: 10px 20px;
      margin: 10px;
      cursor: pointer;
    }
    .muted {
      position: absolute;
      top: 10px;
      right: 10px;
    }
    #ranking ol {
      text-align: left;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Quiz: Lei de Ohm, PotÃªncia e Energia</h1>
    <div id="quiz"></div>
    <div id="ranking"></div>
    <button onclick="toggleMusic()" class="muted">ðŸ”Š MÃºsica</button>
  </div>

  <audio id="bgMusic" src="audio/background.mp3" loop autoplay></audio>
  <audio id="sfxRight" src="audio/certo.mp3"></audio>
  <audio id="sfxWrong" src="audio/errado.mp3"></audio>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-analytics-compat.js"></script>

  <script>
    // Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyAYOdNaZSoHjzQp4MBlTn6AS6yQsV2w4OU",
      authDomain: "jogo-lei-de-ohm.firebaseapp.com",
      databaseURL: "https://jogo-lei-de-ohm-default-rtdb.firebaseio.com",
      projectId: "jogo-lei-de-ohm",
      storageBucket: "jogo-lei-de-ohm.firebasestorage.app",
      messagingSenderId: "570929777785",
      appId: "1:570929777785:web:cf323461fc61b2670e98a8",
      measurementId: "G-2SYC0XWDXW"
    };

    // InicializaÃ§Ã£o
    firebase.initializeApp(firebaseConfig);
    firebase.analytics();
    const database = firebase.database();

    const perguntas = [
      {
        pergunta: "Qual Ã© a fÃ³rmula da Lei de Ohm?",
        opcoes: ["V = R/I", "I = V/R", "P = V * R", "R = V + I"],
        resposta: 1,
        dica: "A corrente Ã© igual Ã  tensÃ£o dividida pela resistÃªncia."
      },
      {
        pergunta: "O que representa a unidade Watt (W)?",
        opcoes: ["ResistÃªncia", "Corrente", "PotÃªncia", "TensÃ£o"],
        resposta: 2,
        dica: "Ã‰ o quanto de energia Ã© consumido por segundo."
      },
      {
        pergunta: "Qual a fÃ³rmula da potÃªncia elÃ©trica?",
        opcoes: ["P = V * I", "P = R / I", "P = V + R", "P = I / V"],
        resposta: 0,
        dica: "Ã‰ a multiplicaÃ§Ã£o da tensÃ£o pela corrente."
      }
    ];

    let indice = 0;
    let pontuacao = 0;
    let tempoRestante = 15;
    let intervalo;

    function tocarSom(id) {
      const som = document.getElementById(id);
      som.currentTime = 0;
      som.play();
    }

    function mostrarPergunta() {
      if (indice >= perguntas.length) return mostrarRanking();

      const p = perguntas[indice];
      document.getElementById("quiz").innerHTML = `
        <p><strong>${p.pergunta}</strong></p>
        ${p.opcoes.map((opcao, i) =>
          `<button onclick="responder(${i})">${opcao}</button>`
        ).join("")}
        <p><button onclick="mostrarDica()">Ver dica</button></p>
        <p>Tempo: <span id="timer">${tempoRestante}</span>s</p>
      `;

      tempoRestante = 15;
      intervalo = setInterval(() => {
        tempoRestante--;
        document.getElementById("timer").innerText = tempoRestante;
        if (tempoRestante <= 0) {
          clearInterval(intervalo);
          proxima();
        }
      }, 1000);
    }

    function responder(i) {
      clearInterval(intervalo);
      const correta = perguntas[indice].resposta;
      if (i === correta) {
        pontuacao += 10;
        tocarSom("sfxRight");
        alert("Acertou!");
      } else {
        tocarSom("sfxWrong");
        alert("Errou!");
      }
      proxima();
    }

    function mostrarDica() {
      alert(perguntas[indice].dica);
    }

    function proxima() {
      indice++;
      mostrarPergunta();
    }

    function mostrarRanking() {
      const nome = prompt("Fim do jogo! Digite seu nome:");
      if (nome) {
        const entrada = { name: nome, score: pontuacao };
        database.ref("ranking").push(entrada);
      }

      database.ref("ranking").orderByChild("score").limitToLast(5).once("value", (snap) => {
        const dados = [];
        snap.forEach(child => dados.push(child.val()));
        dados.reverse();

        document.getElementById("quiz").innerHTML = `
          <h2>Ranking:</h2>
          <ol>${dados.map(e => `<li>${e.name} - ${e.score} pts</li>`).join("")}</ol>
          <button onclick="reiniciar()">Jogar novamente</button>
        `;
      });
    }

    function reiniciar() {
      indice = 0;
      pontuacao = 0;
      mostrarPergunta();
    }

    function toggleMusic() {
      const bg = document.getElementById("bgMusic");
      bg.muted = !bg.muted;
    }

    // Configura mÃºsica de fundo
    const bgMusic = document.getElementById("bgMusic");
    bgMusic.volume = 0.1;

    mostrarPergunta();
  </script>
</body>
</html>
